:root {
  /* Colori categorie */
  --cat-geografia: #2b6cb0;      /* blu */
  --cat-storia: #ecc94b;         /* giallo */
  --cat-arte: #e53e3e;           /* rosso */
  --cat-sport: #dd6b20;          /* arancione */
  --cat-spettacolo: #ed64a6;     /* rosa */
  --cat-scienza: #38a169;        /* verde */

  --color-evento: #805ad5;       /* viola */
  --color-minisfida: #718096;    /* grigio */

  --bg-main: #050816;
  --bg-panel: #111827;
  --text-main: #f7fafc;
  --accent: #f6ad55;
}

/* layout base, si rifinisce dopo */

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: var(--bg-main);
  color: var(--text-main);
}

.layout-center {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.btn {
  display: inline-block;
  padding: 0.8rem 1.4rem;
  border-radius: 999px;
  text-decoration: none;
  font-weight: 600;
}

.btn-primary {
  background: var(--accent);
  color: #1a202c;
}

.btn-secondary {
  background: #2d3748;
  color: #edf2f7;
}

/* ================================
   HOST STAGE (TV layout)
================================ */

#players-panel {
  background: var(--bg-panel);
  border-radius: 1rem;
  padding: 0.5rem;
}

.overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(6px);
  background: rgba(0, 0, 0, 0.55);
}

.overlay.hidden {
  display: none;
}

.overlay.correct-answer {
  background-color: rgba(34, 197, 94, 0.35);
}

.overlay.wrong-answer {
  background-color: rgba(239, 68, 68, 0.35);
}

.message-bar {
  padding: 0.5rem 1rem;
  background: #1a202c;
  font-size: 0.9rem;
}

/* === BOARD GRID (vista debug) === */

.board-grid {
  display: grid;
  /* 14 colonne = 42 caselle circ. si vedono come 3 righe da 14 */
  grid-template-columns: repeat(14, minmax(0, 1fr));
  gap: 4px;
  padding: 8px;
}

.tile {
  position: relative;
  min-height: 60px;
  border-radius: 8px;
  font-size: 0.6rem;
  padding: 4px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  text-align: center;
  white-space: pre-line; /* per andare a capo nei label con "\n" */
}

/* Tipo casella */
.tile--category {
  background: #1f2933;
}

.tile--key {
  background: #ecc94b22;
  border: 2px solid #ecc94b;
}

.tile--event {
  background: var(--color-evento);
}

.tile--minigame {
  background: var(--color-minisfida);
}

.tile--scrigno {
  background: linear-gradient(135deg, gold, #b7791f);
  color: #1a202c;
  font-weight: 700;
}

/* Colori per categoria */
.tile--cat-geografia {
  outline: 2px solid var(--cat-geografia);
}

.tile--cat-storia {
  outline: 2px solid var(--cat-storia);
}

.tile--cat-arte {
  outline: 2px solid var(--cat-arte);
}

.tile--cat-sport {
  outline: 2px solid var(--cat-sport);
}

.tile--cat-spettacolo {
  outline: 2px solid var(--cat-spettacolo);
}

.tile--cat-scienza {
  outline: 2px solid var(--cat-scienza);
}

.tile-id {
  font-weight: 700;
  opacity: 0.9;
}

.tile-type {
  margin-top: 2px;
  font-size: 0.55rem;
  opacity: 0.9;
}

.join-error {
  color: #feb2b2;
  margin-top: 0.5rem;
  font-size: 0.85rem;
}

.players-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.players-list-item {
  padding: 0.4rem 0.5rem;
  border-bottom: 1px solid #2d3748;
  font-size: 0.9rem;
}

.players-list-item--active {
  background: rgba(246, 173, 85, 0.15);
  border-left: 3px solid var(--accent);
}

.player-name {
  font-weight: 600;
}

.player-info {
  font-size: 0.8rem;
  opacity: 0.9;
}

.question-card {
  max-width: 900px;
  width: 90%;
  background: #111827;
  border-radius: 16px;
  padding: 1.5rem;
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
}

.question-header {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 1rem;
  font-size: 0.9rem;
  opacity: 0.9;
}

.question-category {
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.question-text {
  font-size: 1.3rem;
  margin-bottom: 1rem;
}

.answers-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.answer-item {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.4rem;
}

.answer-label {
  font-weight: 700;
}

.question-footer {
  margin-top: 1rem;
  font-size: 0.85rem;
  opacity: 0.85;
}

.answer-buttons {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  margin-top: 0.5rem;
}

/* Host overlay feedback (REVEAL) */
#overlay.correct-answer .question-card {
  outline: 4px solid rgba(34, 197, 94, 0.9);
}

#overlay.wrong-answer .question-card {
  outline: 4px solid rgba(239, 68, 68, 0.9);
}

.answer-item--correct {
  background: rgba(34, 197, 94, 0.15);
  border-radius: 10px;
  padding: 6px 8px;
}

.answer-item--chosen-wrong {
  background: rgba(239, 68, 68, 0.18);
  border-radius: 10px;
  padding: 6px 8px;
}

.answer-item--chosen-correct {
  background: rgba(34, 197, 94, 0.22);
  border-radius: 10px;
  padding: 6px 8px;
}

/* ===== Players panel: Keys + Levels (TV-friendly) ===== */

.player-sep {
  opacity: 0.6;
  margin: 0 6px;
}

.key-row,
.levels-row {
  display: flex;
  gap: 6px;
  margin-top: 6px;
  flex-wrap: nowrap;
}

.key-dot {
  width: 14px;
  height: 14px;
  border-radius: 999px;
  opacity: 0.25;
  outline: 2px solid rgba(255,255,255,0.25);
}

.key-dot--on {
  opacity: 1;
  outline: 2px solid rgba(255,255,255,0.65);
  box-shadow: 0 0 10px rgba(255,255,255,0.15);
}

/* Livelli: barre 0-3 */
.lvl-bar {
  width: 32px;
  height: 10px;
  border-radius: 999px;
  background: rgba(255,255,255,0.10);
  outline: 1px solid rgba(255,255,255,0.20);
  overflow: hidden;
}

/* ===== Player progress (levels clearly visible) ===== */

.player-progress {
  margin-top: 10px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 14px;
  padding: 10px;
}

.pp-title {
  font-weight: 700;
  font-size: 0.9rem;
  margin-bottom: 8px;
  opacity: 0.95;
}

.pp-grid {
  display: grid;
  gap: 6px;
}

.pp-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 6px 8px;
  border-radius: 12px;
}

.pp-row--active {
  outline: 2px solid rgba(246, 173, 85, 0.75);
  background: rgba(246, 173, 85, 0.10);
}

.pp-left {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 140px;
}

.pp-cat {
  text-transform: capitalize;
  font-weight: 700;
  font-size: 0.9rem;
}

.pp-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.pp-lvl {
  font-size: 0.85rem;
  opacity: 0.9;
  min-width: 54px;
  text-align: right;
}

.lvl-bar--key {
  outline: 2px solid rgba(255,255,255,0.60);
  box-shadow: 0 0 10px rgba(255,255,255,0.12);
}

.lvl-fill {
  display: block;
  height: 100%;
  width: 0%;
  background: rgba(255,255,255,0.35);
}

/* 0/3, 1/3, 2/3, 3/3 */
.lvl-fill--0 { width: 0%; }
.lvl-fill--1 { width: 33.33%; }
.lvl-fill--2 { width: 66.66%; }
.lvl-fill--3 { width: 100%; }

/* Colori categoria (riusiamo le CSS var già esistenti) */
.key-dot--geografia, .lvl-bar--geografia .lvl-fill { background: var(--cat-geografia); }
.key-dot--storia, .lvl-bar--storia .lvl-fill { background: var(--cat-storia); }
.key-dot--arte, .lvl-bar--arte .lvl-fill { background: var(--cat-arte); }
.key-dot--sport, .lvl-bar--sport .lvl-fill { background: var(--cat-sport); }
.key-dot--spettacolo, .lvl-bar--spettacolo .lvl-fill { background: var(--cat-spettacolo); }
.key-dot--scienza, .lvl-bar--scienza .lvl-fill { background: var(--cat-scienza); }

.vf-btns { display: flex; gap: 10px; justify-content: center; margin-top: 10px; }

.intruder-btns { display:flex; gap:10px; justify-content:center; margin-top:10px; }

#players-panel {
  min-height: 0;
  overflow: auto;         /* scroll SOLO qui se i players sono tanti */
}

.svg-link {
  stroke: rgba(255,255,255,0.12);
  stroke-width: 4;
  stroke-linecap: round;
}

.svg-tile-id {
  fill: rgba(255,255,255,0.90);
  font-size: 18px;
  font-weight: 800;
  pointer-events: none;
}

.svg-tile-label {
  fill: rgba(255,255,255,0.92);
  font-size: 18px;
  font-weight: 700;
  pointer-events: none;
}

/* ================================
   HEADER COMPATTO (TV MODE)
================================ */
.host-header {
  padding: 6px 16px;
  min-height: unset;
}

.host-title {
  font-size: 20px;          /* prima era enorme */
  font-weight: 700;
  opacity: 0.85;
  margin-bottom: 4px;
}

.host-header .buttons {
  gap: 8px;
}

.host-header button {
  padding: 6px 12px;
  font-size: 13px;
}

.host-header .room-code {
  font-size: 14px;
  margin-top: 2px;
}

/* Mini card */
.player-card {
  pointer-events: none;
  background: rgba(17, 24, 39, 0.92);
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 14px;
  padding: 10px;
  overflow: hidden;
}

.player-card--active {
  outline: 2px solid rgba(246, 173, 85, 0.85);
  box-shadow: 0 0 18px rgba(246, 173, 85, 0.25);
}

.player-card__name {
  font-weight: 800;
  font-size: 0.95rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.player-card__points {
  margin-top: 4px;
  font-weight: 900;
  font-size: 1.2rem;
}

.player-card__keys {
  display: flex;
  gap: 6px;
  margin-top: 8px;
}

.key-dot {
  width: 14px;
  height: 14px;
  border-radius: 999px;
  opacity: 0.22;
  outline: 2px solid rgba(255,255,255,0.18);
}

.key-dot--on {
  opacity: 1;
  outline: 2px solid rgba(255,255,255,0.65);
  box-shadow: 0 0 10px rgba(255,255,255,0.16);
}

/* ================================
   BOARD HIGHLIGHTS (no pedine yet)
================================ */
.svg-tile--occupied {
  stroke-width: 6 !important;
  filter: drop-shadow(0 0 14px rgba(255,255,255,0.45));
}

.svg-tile--active {
  stroke-width: 9 !important;
  filter:
    drop-shadow(0 0 22px rgba(246,173,85,0.95))
    drop-shadow(0 0 48px rgba(246,173,85,0.75));
}

/* SVG riempie tutto lo spazio disponibile */
#board-container .board-svg-wrap {
  width: 100%;
  height: 100%;
  aspect-ratio: auto;
}

#board-container svg {
  width: 100%;
  height: 100%;
  display: block;
}

/* FOOTER */
.host-footer {
  flex: 0 0 auto;
  height: 40px;
  padding: 8px 16px;
  background: rgba(0,0,0,0.35);
}

.host-main.host-layout {
  height: 100%;
  min-height: 0;
}

.board-svg-wrap {
  width: 100%;
  height: 100%;
  max-height: 100%;
}

.svg-tile--scrigno {
  filter:
    drop-shadow(0 0 18px rgba(255,215,0,0.55))
    drop-shadow(0 0 36px rgba(255,215,0,0.25));
}

/* ================================
   HOST LAYOUT – BOARD DOMINANT
================================ */

.page--host {
  height: 100vh;
  overflow: hidden;
}

#host-root {
  height: 100vh;
  display: flex;
  flex-direction: column;
}

/* HEADER */
.host-header {
  flex: 0 0 auto;
  padding: 6px 16px;
}

/* FOOTER */
.host-footer {
  flex: 0 0 auto;
  height: 36px;
  padding: 6px 16px;
  background: rgba(0,0,0,0.35);
}

/* MAIN AREA */
.host-main.host-layout {
  flex: 1 1 auto;
  display: grid;
  grid-template-columns: 140px 1fr 140px;
  min-height: 0;
  padding: 8px;
  gap: 8px;
}

/* PLAYER COLUMNS */
.players-col {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 12px;
  overflow: hidden;
}

/* BOARD CONTAINER */
#board-container {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--bg-panel);
  border-radius: 22px;
  overflow: hidden;
}

/* BOARD WRAP: VINCOLATO ALL'ALTEZZA */
.board-svg-wrap {
  width: 100%;
  height: 100%;
  max-width: 100%;
  max-height: 100%;
}

/* SVG sempre dentro */
.board-svg {
  height: 100%;
  width: 100%;
  display: block;
}

/* ===== FORCE BOARD FULL RECT (override finale) ===== */
#board-container {
  overflow: hidden;
}

#board-container .board-svg-wrap {
  width: 100% !important;
  height: 100% !important;
  max-height: 100% !important;
  aspect-ratio: auto !important;
}

#board-container .board-svg {
  width: 100% !important;
  height: 100% !important;
  display: block;
}

/* --- Direction UI (player) --- */
#direction-buttons.dir-grid-1 {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
}

#direction-buttons.dir-grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.dir-card {
  width: 100%;
  text-align: left;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  color: #fff;
  border-radius: 14px;
  padding: 12px 12px;
  cursor: pointer;
}

.dir-card:active {
  transform: scale(0.99);
}

.dir-card-title {
  font-size: 12px;
  opacity: 0.85;
  margin-bottom: 6px;
  letter-spacing: 0.4px;
}

.dir-card-main {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 6px;
}

.dir-card-sub {
  font-size: 12px;
  opacity: 0.75;
}

/* ================================
   PLAYER – MOBILE FIRST
================================ */

/* evita zoom strani e migliora rendering testo su iOS */
html {
  -webkit-text-size-adjust: 100%;
}

.page--player {
  min-height: 100vh;
  padding:
    max(12px, env(safe-area-inset-top))
    max(12px, env(safe-area-inset-right))
    max(12px, env(safe-area-inset-bottom))
    max(12px, env(safe-area-inset-left));
  box-sizing: border-box;
}

/* contenitore principale più “app-like” */
#player-root {
  max-width: 520px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* header compatto e leggibile */
.player-header {
  background: rgba(255,255,255,0.05);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
  padding: 12px;
}

.player-header h1 {
  margin: 0 0 6px 0;
  font-size: 18px;
}

#player-name-display {
  font-weight: 700;
  opacity: 0.95;
  margin-bottom: 6px;
}

#player-status {
  font-size: 14px;
  opacity: 0.85;
  line-height: 1.25;
}

/* pannelli: trasformiamoli in “card” */
#join-game-panel,
#waiting-panel,
#turn-panel,
#player-cards-panel {
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 16px;
  padding: 12px;
}

/* form join più comodo */
#join-game-form label {
  display: block;
  margin-top: 10px;
  font-size: 14px;
  opacity: 0.9;
}

#join-game-form input {
  width: 100%;
  margin-top: 6px;
  padding: 12px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.25);
  color: #fff;
  font-size: 16px; /* evita zoom iOS su focus */
  box-sizing: border-box;
}

/* bottoni: touch target minimo */
.btn {
  width: 100%;
  padding: 14px 14px;
  font-size: 16px;
  border-radius: 16px;
  box-sizing: border-box;
}

/* area turno: spazi più stretti */
#turn-panel h2 {
  margin: 0 0 6px 0;
  font-size: 16px;
}

/* DADO: resa “mobile” */
#dice-panel {
  display: grid;
  grid-template-columns: 1fr;
  gap: 10px;
  margin-top: 10px;
}

#dice-result {
  font-size: 15px;
  opacity: 0.9;
}

/* RISPOSTE A/B/C/D: griglia 2x2 comoda */
.answer-buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.answer-btn {
  min-height: 52px;
  font-size: 18px;
  border-radius: 16px;
}

/* DIREZIONI: griglia “mobile responsive” */
#direction-panel > p {
  margin: 8px 0 10px;
  font-size: 14px;
  opacity: 0.9;
}

#direction-buttons.dir-grid-1,
#direction-buttons.dir-grid-2 {
  display: grid;
  gap: 10px;
}

/* su telefoni: sempre 2 colonne se ci sta, altrimenti 1 */
#direction-buttons.dir-grid-2 {
  grid-template-columns: 1fr 1fr;
}
#direction-buttons.dir-grid-1 {
  grid-template-columns: 1fr;
}

/* card direzioni: più “tap-friendly” */
.dir-card {
  padding: 14px 12px;
  border-radius: 16px;
  min-height: 74px;
}

.dir-card-title {
  font-size: 12px;
}

.dir-card-main {
  font-size: 16px;
}

.dir-card-sub {
  font-size: 12px;
  line-height: 1.2;
}

/* Minigame panels: bottoni affiancati su mobile */
.vf-btns,
.intruder-btns {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  justify-content: stretch;
}

#closest-input {
  width: 100%;
  margin-top: 8px;
  padding: 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(0,0,0,0.25);
  color: #fff;
  font-size: 16px; /* evita zoom iOS */
  box-sizing: border-box;
}

/* progress: più compatto */
.player-progress {
  padding: 10px;
}

.pp-left {
  min-width: 120px;
}

/* =========================
   HOST HALL (pre-game)
   ========================= */

.host-hall {
  min-height: 100vh;
  display: grid;
  place-items: center;
  padding: 16px;
}

.hall-card {
  width: min(980px, 100%);
  border-radius: 18px;
  padding: 18px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(10px);
}

.hall-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.hall-brand { display: grid; gap: 4px; }
.hall-title { font-size: 20px; font-weight: 800; letter-spacing: 0.5px; }
.hall-subtitle { opacity: 0.85; font-size: 14px; }

.hall-actions {
  margin-top: 14px;
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.hall-actions .btn {
  width: auto; /* i tuoi .btn sono full-width per player, qui li facciamo “desktop” */
}

.hall-join {
  margin-top: 16px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}

@media (max-width: 860px) {
  .hall-join { grid-template-columns: 1fr; }
}

.hall-label { font-size: 12px; opacity: 0.8; margin-bottom: 6px; }

.hall-code-box {
  font-size: 26px;
  font-weight: 900;
  letter-spacing: 6px;
  padding: 12px 14px;
  border-radius: 14px;
  background: rgba(0,0,0,0.25);
  border: 1px solid rgba(255,255,255,0.10);
  user-select: all;
}

.hall-hint, .qr-hint {
  margin-top: 8px;
  font-size: 12px;
  opacity: 0.85;
}

.qr-wrap {
  padding: 12px;
  border-radius: 14px;
  background: rgba(0,0,0,0.20);
  border: 1px solid rgba(255,255,255,0.10);
  display: grid;
  gap: 10px;
  place-items: start center;
}

.qr-code {
  width: 220px;
  height: 220px;
  border-radius: 12px;
  background: rgba(255,255,255,0.06);
  border: 1px dashed rgba(255,255,255,0.18);
  display: grid;
  place-items: center;
  overflow: hidden;
}

.hall-message {
  margin-top: 14px;
  min-height: 20px;
  opacity: 0.9;
}

/* ===== Player mobile-first shell ===== */

.player-shell {
  min-height: 100vh;
  display: grid;
  grid-template-rows: auto 1fr auto;
}

.player-topbar {
  position: sticky;
  top: 0;
  z-index: 20;
  padding: 10px 12px;
  display: flex;
  justify-content: space-between;
  gap: 12px;
  background: rgba(0,0,0,0.35);
  border-bottom: 1px solid rgba(255,255,255,0.10);
  backdrop-filter: blur(10px);
}

.player-topbar-title { font-weight: 900; letter-spacing: 1px; font-size: 14px; opacity: 0.9; }
.player-topbar-name { font-size: 12px; opacity: 0.85; margin-top: 2px; }
.player-topbar-status { font-size: 12px; opacity: 0.85; text-align: right; }

.player-content {
  padding: 14px 12px 18px;
  display: grid;
  place-items: start center;
}

.panel-card {
  width: min(520px, 100%);
  border-radius: 18px;
  padding: 16px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
  backdrop-filter: blur(10px);
}

.panel-header h2 { margin: 0 0 6px; }
.panel-subtitle { margin: 0 0 10px; opacity: 0.85; font-size: 13px; }

.form-stack { display: grid; gap: 12px; }

.field { display: grid; gap: 6px; }
.field > span { font-size: 12px; opacity: 0.85; }

.btn-full { width: 100%; }
.btn-big { padding: 14px 16px; font-size: 16px; border-radius: 14px; }

.input-big { width: 100%; padding: 12px 12px; border-radius: 12px; }

.turn-status { margin: 10px 0 0; opacity: 0.9; }

.dice-result { margin-top: 10px; font-size: 18px; font-weight: 800; text-align: center; }

.player-cards { padding: 10px 12px 16px; }

/* ===== Host: wrapper della vista tabellone ===== */
.host-game {
  height: 100%;
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.hidden {
  display: none !important;
}

/* ================================
   BOARD – SPOTLIGHT DIREZIONI (HOST)
================================ */

/* attenua il resto della board quando si scelgono direzioni */
.svg-tile--dim {
  opacity: 0.22;
  filter: saturate(0.65) brightness(0.85);
}

/* pulsazione “strong”: glow + micro-zoom + stroke più visibile */
@keyframes tilePulseStrong {
  0% {
    transform: scale(1);
    filter:
      drop-shadow(0 0 6px rgba(255,255,255,0.20))
      drop-shadow(0 0 18px rgba(246,173,85,0.25));
  }
  45% {
    transform: scale(1.055);
    filter:
      drop-shadow(0 0 10px rgba(255,255,255,0.35))
      drop-shadow(0 0 26px rgba(246,173,85,0.55))
      drop-shadow(0 0 60px rgba(246,173,85,0.35));
  }
  100% {
    transform: scale(1);
    filter:
      drop-shadow(0 0 6px rgba(255,255,255,0.18))
      drop-shadow(0 0 18px rgba(246,173,85,0.22));
  }
}

/* Nota: transform su SVG funziona meglio con transform-box + origin */
.svg-tile--pulse {
  transform-box: fill-box;
  transform-origin: center;
  animation: tilePulseStrong 0.9s ease-in-out infinite;
  stroke: rgba(255,255,255,0.85) !important; /* più “neon” */
  stroke-width: 9 !important;               /* più impatto */
}
/* =========================
   CARDS DOCK (mobile)
========================= */
.cards-dock {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 10px 12px;
  background: rgba(10, 10, 20, 0.92);
  backdrop-filter: blur(8px);
  border-top: 1px solid rgba(255,255,255,0.10);
  z-index: 999;
}

.cards-dock-title {
  font-size: 12px;
  opacity: 0.85;
  margin-bottom: 6px;
}

.cards-slots {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.card-slot {
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  border-radius: 12px;
  padding: 10px 8px;
  min-height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  cursor: pointer;
  user-select: none;
}

.card-slot.disabled {
  opacity: 0.45;
  cursor: not-allowed;
}

.card-icon {
  font-size: 18px;
  line-height: 1;
}

.card-label {
  font-size: 12px;
  line-height: 1.1;
  text-align: center;
}

/* lascia spazio al dock SOLO quando è visibile */
body.has-cards-dock {
  padding-bottom: 92px;
}

/* =========================
   CARD SHEET
========================= */
.card-sheet {
  position: fixed;
  inset: 0;
  z-index: 1000;
}

.card-sheet-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.55);
}

.card-sheet-panel {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(20,20,32,0.98);
  border-top-left-radius: 18px;
  border-top-right-radius: 18px;
  padding: 14px 14px 16px;
  border-top: 1px solid rgba(255,255,255,0.10);
}

.card-sheet-head {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.card-sheet-title {
  font-size: 14px;
  font-weight: 600;
}

.card-sheet-close {
  border: none;
  background: transparent;
  color: inherit;
  font-size: 18px;
  cursor: pointer;
  opacity: 0.9;
}

.card-sheet-desc {
  margin-top: 10px;
  font-size: 13px;
  opacity: 0.9;
  line-height: 1.35;
}

.card-sheet-actions {
  margin-top: 12px;
  display: flex;
  gap: 10px;
}

.card-use-btn {
  width: 100%;
  border: none;
  border-radius: 12px;
  padding: 12px 10px;
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
}

.card-use-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* 50/50: risposte eliminate */
.fifty-removed {
  opacity: 0.25;
  filter: grayscale(1);
  pointer-events: none;
}

.card-offer { position: fixed; inset: 0; z-index: 1200; }
.card-offer-backdrop { position:absolute; inset:0; background: rgba(0,0,0,0.6); }
.card-offer-panel {
  position:absolute; left:12px; right:12px; bottom:12px;
  background: rgba(20,20,32,0.98);
  border-radius: 18px;
  padding: 14px;
  border: 1px solid rgba(255,255,255,0.10);
}
.card-offer-title { font-weight: 800; font-size: 14px; margin-bottom: 10px; }
.card-offer-card { padding: 10px; border-radius: 14px; background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.10); }
.card-offer-sub { margin-top: 10px; font-size: 12px; opacity: 0.9; }
.card-offer-discard-list { margin-top: 8px; display:flex; gap:8px; flex-wrap:wrap; }
.card-offer-chip {
  padding: 8px 10px; border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.14);
  background: rgba(255,255,255,0.06);
  font-size: 12px;
  cursor: pointer;
}
.card-offer-chip.selected { outline: 2px solid rgba(255,255,255,0.5); }
.card-offer-actions { margin-top: 12px; display:flex; gap:10px; }
.card-offer-btn { flex:1; border:none; border-radius: 12px; padding: 12px 10px; font-weight: 900; }
.card-offer-btn.primary { }

.cat-grid{
  margin-top: 10px;
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
.cat-btn{
  border:none;
  border-radius:14px;
  padding:14px 10px;
  font-weight:900;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.12);
  color: #fff;
}
.cat-btn:disabled{
  opacity:0.45;
}

/* =========================
   TOAST / BANNER (Host+Player)
   ========================= */
.trivium-toast {
  position: fixed;
  top: 22px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 99999;
  min-width: 280px;
  max-width: min(720px, calc(100vw - 24px));
  padding: 14px 16px;
  border-radius: 14px;
  backdrop-filter: blur(10px);
  background: rgba(20, 20, 24, 0.78);
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 10px 40px rgba(0,0,0,0.35);
  color: #fff;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  animation: triviumToastIn 220ms ease-out;
}

.trivium-toast.hidden { display: none; }

.trivium-toast .title {
  font-weight: 800;
  font-size: 16px;
  letter-spacing: 0.2px;
}
.trivium-toast .subtitle {
  margin-top: 4px;
  opacity: 0.9;
  font-size: 13px;
  line-height: 1.3;
}

.trivium-toast.success { border-color: rgba(46, 204, 113, 0.35); }
.trivium-toast.danger  { border-color: rgba(231, 76, 60, 0.35); }
.trivium-toast.neutral { border-color: rgba(52, 152, 219, 0.35); }

@keyframes triviumToastIn {
  from { transform: translateX(-50%) translateY(-10px); opacity: 0; }
  to   { transform: translateX(-50%) translateY(0); opacity: 1; }
}

.overlay-topbar{
  display:flex; gap:10px; align-items:center; justify-content:space-between;
  margin-bottom:10px;
}
.overlay-badges{ display:flex; gap:8px; flex-wrap:wrap; }
.badge{
  display:inline-flex; align-items:center; gap:6px;
  padding:6px 10px; border-radius:999px;
  font-weight:800; font-size:12px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
}
.badge--success{ border-color: rgba(46,204,113,.35); }
.badge--danger{ border-color: rgba(231,76,60,.35); }

/* ===============================
   DUELLO – RESPONDERS
   =============================== */
.responders {
  margin-top: 14px;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
}

.responder {
  padding: 10px 12px;
  border-radius: 14px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.14);
}

.responder .name {
  font-weight: 900;
}

.responder .meta {
  margin-top: 4px;
  font-size: 13px;
  font-weight: 700;
  opacity: 0.9;
}

.responder.done {
  outline: 2px solid rgba(46, 204, 113, 0.35);
}

.responder.pending {
  opacity: 0.75;
}

.responder.is-correct { outline: 2px solid rgba(46, 204, 113, 0.35); }
.responder.is-wrong   { outline: 2px solid rgba(231, 76, 60, 0.35); }

/* =========================================
   TV SHOW OVERLAY (HOST) — BIG, FULLSCREEN
   ========================================= */

#overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;

  /* sfondo “studio” */
  background: radial-gradient(1200px 700px at 50% 35%, rgba(255,255,255,0.10), rgba(0,0,0,0.78));
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  padding: 40px;
}

#overlay.hidden {
  display: none;
}

#overlay-content {
  width: min(1200px, 92vw);
  max-height: 88vh;
  overflow: auto;
}

/* Card enorme stile show */
.question-card {
  border-radius: 24px;
  padding: 26px 28px;

  background: linear-gradient(180deg, rgba(18,18,24,0.92), rgba(10,10,14,0.88));
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 25px 90px rgba(0,0,0,0.55);

  transform: translateY(8px) scale(0.99);
  animation: tvCardIn 220ms ease-out forwards;
}

@keyframes tvCardIn {
  to { transform: translateY(0) scale(1); }
}

/* Header più “presenter” */
.question-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 18px;
}

.question-category {
  font-size: 22px;
  font-weight: 900;
  letter-spacing: 0.6px;
  text-transform: uppercase;
  opacity: 0.95;
}

.question-player {
  font-size: 18px;
  font-weight: 800;
  opacity: 0.9;
}

/* Domanda gigante */
.question-text {
  font-size: 34px;
  line-height: 1.18;
  font-weight: 900;
  margin: 16px 0 18px 0;
}

/* Risposte grandi, “pulsanti” */
.answers-list {
  display: grid;
  grid-template-columns: 1fr;
  gap: 12px;
  margin: 0;
  padding: 0;
  list-style: none;
}

.answer-item {
  border-radius: 18px;
  padding: 16px 18px;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.12);
  font-size: 22px;
  font-weight: 800;
}

.answer-label {
  display: inline-block;
  min-width: 36px;
  opacity: 0.9;
}

/* Stato corretto / sbagliato più “show” */
#overlay.correct-answer .question-card {
  box-shadow: 0 25px 90px rgba(0,0,0,0.55), 0 0 0 3px rgba(46, 204, 113, 0.30);
}

#overlay.wrong-answer .question-card {
  box-shadow: 0 25px 90px rgba(0,0,0,0.55), 0 0 0 3px rgba(231, 76, 60, 0.28);
}

.answer-item--correct {
  background: rgba(46,204,113,0.16);
  border-color: rgba(46,204,113,0.40);
}

/* footer più leggibile */
.question-footer {
  margin-top: 16px;
  font-size: 18px;
  font-weight: 800;
  opacity: 0.9;
}

/* Topbar in stile “broadcast” */
.overlay-topbar {
  display: flex;
  justify-content: space-between;
  margin-bottom: 14px;
}

.overlay-badges {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.badge {
  padding: 10px 14px;
  border-radius: 999px;
  font-weight: 900;
  font-size: 14px;
  letter-spacing: 0.4px;
  background: rgba(255,255,255,0.10);
  border: 1px solid rgba(255,255,255,0.16);
}

/* responders del duello più “TV” */
.responders {
  margin-top: 16px;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 12px;
}

.responder {
  padding: 14px 14px;
  border-radius: 18px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.12);
}

.responder .name { font-weight: 950; font-size: 18px; }
.responder .meta { margin-top: 6px; font-weight: 800; opacity: .9; }

.responder.is-correct { outline: 3px solid rgba(46, 204, 113, 0.35); }
.responder.is-wrong   { outline: 3px solid rgba(231, 76, 60, 0.30); }

#overlay::before {
  content: "";
  position: absolute;
  inset: -40px;
  background: radial-gradient(800px 480px at 50% 35%, rgba(255,255,255,0.10), rgba(0,0,0,0.75));
  pointer-events: none;
}
#overlay::after {
  content: "";
  position: absolute;
  inset: 0;
  box-shadow: inset 0 0 120px rgba(0,0,0,0.72);
  pointer-events: none;
}
#overlay-content { position: relative; z-index: 1; }

/* =========================================
   BROADCAST SCOREBOARD (HOST)
   ========================================= */

.player-card {
  border-radius: 22px;
  padding: 16px 16px;
  background: rgba(10,10,14,0.65);
  border: 1px solid rgba(255,255,255,0.14);
  box-shadow: 0 16px 50px rgba(0,0,0,0.35);
}

.player-card.active {
  box-shadow: 0 16px 50px rgba(0,0,0,0.35), 0 0 0 3px rgba(80, 180, 255, 0.35);
  transform: translateY(-2px);
}

.player-card__name {
  font-size: 22px;
  font-weight: 950;
  letter-spacing: 0.3px;
  margin-bottom: 6px;
}

.player-card__points {
  font-size: 34px;
  font-weight: 950;
  letter-spacing: 0.6px;
  margin-bottom: 10px;
}

.player-card__keys {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

/* “Chiavi” più show: icone animate */
.player-key {
  width: 28px;
  height: 28px;
  border-radius: 999px;
  background: rgba(255,255,255,0.10);
  border: 1px solid rgba(255,255,255,0.16);
  position: relative;
  overflow: hidden;
}

.player-key.filled {
  background: rgba(255,255,255,0.18);
  border-color: rgba(255,255,255,0.28);
  animation: keyGlow 1.2s ease-in-out infinite;
}

@keyframes keyGlow {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.35); }
}

/* =========================================
   SCENE TRANSITION + FULLSCREEN OVERLAY
   ========================================= */

#overlay {
  position: fixed;
  inset: 0;
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;

  background: rgba(0,0,0,0.78);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);

  padding: 44px;
  opacity: 1;
  transition: opacity 180ms ease;
}

#overlay.hidden {
  display: none;
}

#overlay-content {
  width: min(1200px, 92vw);
  max-height: 88vh;
  overflow: auto;
}

/* Entrata “scene” */
#overlay:not(.hidden) #overlay-content {
  animation: sceneIn 220ms ease-out;
}
@keyframes sceneIn {
  from { transform: translateY(18px) scale(0.98); opacity: 0.35; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}

/* =========================================
   WINNER SCREEN (HOST)
   ========================================= */

#overlay.winner-mode #overlay-content {
  width: min(1400px, 94vw);
}

.winner-screen {
  border-radius: 28px;
  padding: 46px 42px;
  text-align: center;

  background: linear-gradient(180deg, rgba(18,18,24,0.92), rgba(10,10,14,0.88));
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow: 0 30px 120px rgba(0,0,0,0.60);
}

.winner-title {
  font-size: 64px;
  font-weight: 1000;
  letter-spacing: 1px;
  line-height: 1.05;
}

.winner-subtitle {
  margin-top: 14px;
  font-size: 28px;
  font-weight: 850;
  opacity: 0.92;
}

#overlay.winner-success .winner-screen { box-shadow: 0 30px 120px rgba(0,0,0,0.60), 0 0 0 4px rgba(46,204,113,0.28); }
#overlay.winner-danger  .winner-screen { box-shadow: 0 30px 120px rgba(0,0,0,0.60), 0 0 0 4px rgba(231,76,60,0.24); }
#overlay.winner-neutral .winner-screen { box-shadow: 0 30px 120px rgba(0,0,0,0.60), 0 0 0 4px rgba(80,180,255,0.26); }

/* “spark” finto (effetto show) */
.winner-spark {
  margin: 24px auto 0;
  width: 320px;
  height: 6px;
  border-radius: 999px;
  background: rgba(255,255,255,0.18);
  position: relative;
  overflow: hidden;
}
.winner-spark::after {
  content: "";
  position: absolute;
  inset: 0;
  transform: translateX(-60%);
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.65), transparent);
  animation: sparkMove 1.1s ease-in-out infinite;
}
@keyframes sparkMove {
  0% { transform: translateX(-60%); }
  100% { transform: translateX(60%); }
}
